---
permalink: afx-1k/rtc-battery-replace.html 
sidebar: sidebar 
keywords: afx 1k, replace the real-time clock battery 
summary: 'Substitua a bateria do relógio em tempo real (RTC), comumente conhecida como bateria de célula tipo moeda, no seu sistema de armazenamento AFX 1K para garantir que os serviços e aplicativos que dependem da sincronização precisa de tempo permaneçam operacionais.' 
---
= Substituir a bateria do relógio em tempo real - AFX 1K
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Substitua a bateria do relógio em tempo real (RTC), comumente conhecida como bateria de célula tipo moeda, no seu sistema de armazenamento AFX 1K para garantir que os serviços e aplicativos que dependem da sincronização precisa de tempo permaneçam operacionais.

.Antes de começar
* Entenda que você pode usar este procedimento com todas as versões do ONTAP suportadas pelo seu sistema.
* Certifique-se de que todos os outros componentes do sistema estão a funcionar corretamente; caso contrário, tem de contactar a assistência técnica.




== Passo 1: Desligue o controlador desativado

Encerre ou assuma o controlador afetado utilizando uma das seguintes opções.

Para desligar o controlador com defeito, você deve determinar o status do controlador e, se necessário, executar uma aquisição de failover de armazenamento do controlador para que o controlador íntegro continue a fornecer dados do armazenamento do controlador com defeito.

.Sobre esta tarefa
* Se você tiver um cluster com mais de quatro nós, ele deverá estar no quorum.  Para visualizar informações de cluster sobre seus nós, use o `cluster show` comando.  Para mais informações sobre o `cluster show` comando, vejalink:https://docs.netapp.com/us-en/ontap/system-admin/display-nodes-cluster-task.html["Exibir detalhes no nível do nó em um cluster ONTAP"^] .
* Se o cluster não estiver em quorum ou se a integridade ou elegibilidade de qualquer controlador (exceto o controlador com defeito) for mostrada como falsa, você deverá corrigir o problema antes de desligar o controlador com defeito. Ver link:https://docs.netapp.com/us-en/ontap/system-admin/synchronize-node-cluster-task.html?q=Quorum["Sincronize um nó com o cluster"^] .


.Passos
. Se o AutoSupport estiver ativado, suprimir a criação automática de casos invocando uma mensagem AutoSupport:
+
`system node autosupport invoke -node * -type all -message MAINT=<# of hours>h`

+
A seguinte mensagem AutoSupport suprime a criação automática de casos por duas horas:

+
`cluster1:> system node autosupport invoke -node * -type all -message MAINT=2h`

. Desabilitar o retorno automático do console do controlador prejudicado:
+
`storage failover modify -node impaired-node -auto-giveback-of false`

+

NOTE: Quando você vir _Deseja desabilitar o retorno automático?_, digite `y` .

+
.. Se você estiver executando o ONTAP versão 9.17.1 e o controlador com problemas não puder ser ativado ou já tiver sido assumido, será necessário desativar o link de interconexão HA do controlador íntegro antes de inicializar o controlador com problemas.  Isso impede que o controlador prejudicado execute o retorno automático.
+
`system ha interconnect link off -node healthy-node -link 0`

+
`system ha interconnect link off -node healthy-node -link 1`



. Leve o controlador prejudicado para o prompt Loader:
+
[cols="1,2"]
|===
| Se o controlador afetado estiver a apresentar... | Então... 


 a| 
O prompt Loader
 a| 
Vá para a próxima etapa.



 a| 
Prompt do sistema ou prompt de senha
 a| 
Assuma ou interrompa o controlador prejudicado do controlador saudável:
`storage failover takeover -ofnode _impaired_node_name_ -halt _true_`

O parâmetro _-halt true_ leva o nó prejudicado ao prompt do LOADER.

|===




== Passo 2: Remova o módulo do controlador

Você deve remover o módulo do controlador do gabinete quando substituir o módulo do controlador ou substituir um componente dentro do módulo do controlador.

. Verifique o LED de status do NVRAM localizado no slot 4/5 do sistema. Há também um LED NVRAM no painel frontal do módulo do controlador. Procure o ícone NV:
+
image::../media/drw_a1K-70-90_nvram-led_ieops-1463.svg[Gráfico de localização do LED de estado e atenção do NVRAM]

+
[cols="1,4"]
|===


 a| 
image:../media/icon_round_1.png["Legenda número 1"]
 a| 
LED de estado do NVRAM



 a| 
image:../media/icon_round_2.png["Legenda número 2"]
 a| 
LED de atenção NVRAM

|===
+
** Se o LED NV estiver desligado, passe à próxima etapa.
** Se o LED NV estiver intermitente, aguarde que o intermitente pare. Se a intermitência continuar durante mais de 5 minutos, contacte o suporte técnico para obter assistência.


. Se você ainda não está aterrado, aterre-se adequadamente.
. Remova o painel (se necessário) com as duas mãos, segurando as aberturas em cada lado do painel e puxando em sua direção até que o painel se solte dos pinos esféricos na estrutura do chassi.
. Na parte da frente da unidade, prenda os dedos nos orifícios dos cames de bloqueio, aperte as patilhas nas alavancas do excêntrico e, com cuidado, mas rode firmemente ambas as travas na sua direção ao mesmo tempo.
+
O módulo do controlador move-se ligeiramente para fora do compartimento.

+
image::../media/drw_a1k_pcm_remove_replace_ieops-1375.svg[Controlador remover gráfico]

+
[cols="1,4"]
|===


 a| 
image:../media/icon_round_1.png["Legenda número 1"]
| Travas do came de travamento 
|===
. Deslize o módulo do controlador para fora do compartimento e coloque-o em uma superfície plana e estável.
+
Certifique-se de que suporta a parte inferior do módulo do controlador enquanto o desliza para fora do compartimento.





== Passo 3: Substitua a bateria RTC

Remova a bateria RTC com defeito e instale a substituição.

. Abra a conduta de ar do controlador na parte superior do controlador.
+
.. Insira os dedos nas reentrâncias nas extremidades distantes da conduta de ar.
.. Levante a conduta de ar e rode-a para cima o mais longe possível.


. Localize a bateria do RTC sob a conduta de ar.
+
image::../media/drw_a1k_rtc_remove_replace_ieops-1381.svg[Substitua a bateria do RTC]

+
[cols="1,4"]
|===


 a| 
image:../media/icon_round_1.png["Legenda número 1"]
| Bateria e alojamento RTC 
|===
. Empurre cuidadosamente a bateria para fora do suporte, rode-a para fora do suporte e, em seguida, levante-a para fora do suporte.
+

NOTE: Observe a polaridade da bateria ao removê-la do suporte.  A bateria é marcada com um sinal de mais e deve ser posicionada corretamente no suporte.  Um sinal de mais próximo ao suporte indica a orientação correta.

. Retire a bateria de substituição do saco de transporte antiestático.
. Observe a polaridade da bateria RTC e, em seguida, insira-a no suporte inclinando a bateria em ângulo e empurrando-a para baixo.
. Inspecione visualmente a bateria para se certificar de que está completamente instalada no suporte e de que a polaridade está correta.




== Etapa 4: Reinstale o módulo do controlador

Reinstale o módulo do controlador e inicialize-o.

. Certifique-se de que a conduta de ar está completamente fechada, rodando-a até onde for.
+
Ele deve estar alinhado com a chapa metálica do módulo do controlador.

. Alinhe a extremidade do módulo do controlador com a abertura no compartimento e deslize o módulo do controlador para dentro do chassi com as alavancas giradas para longe da frente do sistema.
. Assim que o módulo do controlador o impedir de deslizar para mais longe, rode as pegas do excêntrico para dentro até que fiquem presas por baixo das ventoinhas
+

NOTE: Não use força excessiva ao deslizar o módulo do controlador para dentro do compartimento para evitar danificar os conetores.

+
O módulo do controlador começa a inicializar assim que estiver totalmente encaixado no compartimento.

. Alinhe a moldura com os pinos esféricos e empurre-a delicadamente para o lugar.




== Passo 5: Redefina a hora e a data no controlador


NOTE: Após substituir a bateria do RTC, inserir o controlador e ligar o primeiro BIOS, você verá as seguintes mensagens de erro:
`RTC date/time error. Reset date/time to default`
`RTC power failure error` Essas mensagens são esperadas e você pode continuar com este procedimento.

. Verifique a data e a hora no controlador saudável com o `cluster date show` comando.
+

NOTE: Se o sistema parar no menu de inicialização, selecione a opção  `Reboot node`e responda _y_ quando solicitado e, em seguida, inicialize no Loader pressionando _Ctrl-C_

+
.. No prompt LOADER no controlador de destino, verifique a hora e a data com o `show date` comando.
.. Se necessário, modifique a data com o `set date mm/dd/yyyy` comando.
.. Se necessário, defina a hora, em GMT, usando o `set time hh:mm:ss` comando.
+
... Você pode obter o GMT atual do nó parceiro com o `date -u` comando.




. Confirme a data e a hora no controlador de destino.
. No prompt Loader, digite `bye` para reinicializar as placas PCIe e outros componentes e deixar a controladora reiniciar.
. Pressione <enter> quando as mensagens do console pararem.
+
** Se você vir o prompt _login_, vá para a próxima etapa.
** Se você não vir o prompt de login, faça login no nó do parceiro.


. Devolva apenas a raiz com a opção override-destination-checks:
+
`storage failover giveback -ofnode impaired-node -only-root true -override -destination-checks true`

+

NOTE: O comando a seguir só está disponível no nível de privilégio Modo de diagnóstico.  Para obter mais informações sobre níveis de privilégio, consultelink:https://docs.netapp.com/us-en/ontap/system-admin/administrative-privilege-levels-concept.html["Entenda os níveis de privilégio para comandos ONTAP CLI"^] .

+
Se encontrar erros, https://support.netapp.com["Suporte à NetApp"] contacte .

. Aguarde cinco minutos após a conclusão do relatório de devolução e verifique os status de failover e devolução:
+
`storage failover show`e `storage failover show-giveback`

+

NOTE: O comando a seguir só está disponível no nível de privilégio Modo de diagnóstico.

. Se os links de interconexão HA foram desativados, reative-os:
+
`system ha interconnect link on -node healthy-node -link 0`

+
`system ha interconnect link on -node healthy-node -link 1`

. Volte a colocar o controlador afetado em funcionamento normal, devolvendo o respetivo armazenamento:
+
`storage failover giveback -ofnode _impaired_node_name_`

. Se a giveback automática foi desativada, reative-a:
+
`storage failover modify -node local -auto-giveback-of true`

. Se o AutoSupport estiver ativado, restaurar/anular a criação automática de casos:
+
`system node autosupport invoke -node * -type all -message MAINT=END`





== Passo 6: Devolva a peça com falha ao NetApp

Devolva a peça com falha ao NetApp, conforme descrito nas instruções de RMA fornecidas com o kit. Consulte a https://mysupport.netapp.com/site/info/rma["Devolução de peças e substituições"] página para obter mais informações.
